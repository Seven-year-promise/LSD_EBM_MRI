Pytorch Version: 1.9.0+cu111
Experiment: Train
Namespace(EBM_reg=0, batch_size=4, beta_end=0.01, beta_start=0.0001, cond_mcmc_step_size=0.01, cond_mcmc_steps_tr=300, cond_mcmc_steps_val=300, dec_dyn_lr=None, dec_lr=2e-05, diff_timesteps=30, ebm_dyn_lr=None, ebm_inner_dim=1000, ebm_lr=2e-05, ebm_num_layers=1, enc_dyn_lr=None, enc_lr=2e-05, ep_betw_val=2, epoch_start=200, experiment='Train', gen_var=0.3, load_from_ep=None, num_channels=16, num_epochs=0, num_latents=100, prior_bn=False, prior_var=1.0, recon_loss='bce', save_model=True, save_visu=True, test_perf=True, test_set='XXX_bodies_data_test', train_set='XXX_bodies_data_train', validation_set='XXX_bodies_data_validation')
Main path:  ./../Vert_data/LSD-EBM_Vert/
num_channel 16
num_latent 100
num_channel 16
num_latent 100
e_func num parameters:  1104001
enc_model num parameters:  26336276
dec_model num parameters:  26594865
Training set size:  446
Validation set size:  73
Test set size:  74
/itet-stor/yankwang/net_scratch/conda_envs/ve_py37_lsd_A100_20230202/lib/python3.7/site-packages/scipy/ndimage/interpolation.py:583: UserWarning: From scipy 0.13.0, the output shape of zoom() is calculated with round() instead of int() - for these inputs the size of the returned array has changed.
  "the returned array has changed.", UserWarning)
main_LSDEBM_Vert_01.py:162: UserWarning: torch.range is deprecated and will be removed in a future release because its behavior is inconsistent with Python's range builtin. Instead, use torch.arange, which produces values in [start, end).
  insert_mask = (torch.ones(hor+1)*t == torch.range(0, hor)).float().to(noise.device)
main_LSDEBM_Vert_01.py:29: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  dice_score = dc(pred.astype(np.int),gt.astype(np.int))
0 / 74 : Dice= 0.0
1 / 74 : Dice= 0.0
2 / 74 : Dice= 0.0
3 / 74 : Dice= 0.0
4 / 74 : Dice= 0.0
5 / 74 : Dice= 0.0
6 / 74 : Dice= 0.0
7 / 74 : Dice= 0.0
8 / 74 : Dice= 0.0
9 / 74 : Dice= 0.0
10 / 74 : Dice= 0.0
11 / 74 : Dice= 0.0
12 / 74 : Dice= 0.0
13 / 74 : Dice= 0.0
14 / 74 : Dice= 0.0
15 / 74 : Dice= 0.0009046908219116117
16 / 74 : Dice= 0.0
17 / 74 : Dice= 0.0
18 / 74 : Dice= 0.0
19 / 74 : Dice= 0.00254199508674084
20 / 74 : Dice= 0.0
21 / 74 : Dice= 0.0
22 / 74 : Dice= 0.0
23 / 74 : Dice= 0.0
24 / 74 : Dice= 0.0
25 / 74 : Dice= 0.0
26 / 74 : Dice= 0.00252009867428612
27 / 74 : Dice= 0.0
28 / 74 : Dice= 0.0
29 / 74 : Dice= 0.0
30 / 74 : Dice= 0.0
31 / 74 : Dice= 0.0
32 / 74 : Dice= 0.0
33 / 74 : Dice= 0.0
34 / 74 : Dice= 0.0
35 / 74 : Dice= 0.0
36 / 74 : Dice= 0.0
37 / 74 : Dice= 0.0
38 / 74 : Dice= 0.0
39 / 74 : Dice= 0.0
40 / 74 : Dice= 0.0
41 / 74 : Dice= 0.0
42 / 74 : Dice= 0.0
43 / 74 : Dice= 0.0
44 / 74 : Dice= 0.004946671570430305
45 / 74 : Dice= 0.0
46 / 74 : Dice= 0.0
47 / 74 : Dice= 0.0
48 / 74 : Dice= 0.0
49 / 74 : Dice= 0.0
50 / 74 : Dice= 0.0
51 / 74 : Dice= 0.0
52 / 74 : Dice= 0.0
53 / 74 : Dice= 0.0
54 / 74 : Dice= 0.0
55 / 74 : Dice= 0.0
56 / 74 : Dice= 0.0
57 / 74 : Dice= 0.0
58 / 74 : Dice= 0.0
59 / 74 : Dice= 0.0
60 / 74 : Dice= 0.0
61 / 74 : Dice= 0.0
62 / 74 : Dice= 0.0
63 / 74 : Dice= 0.0
64 / 74 : Dice= 6.0728130282082166e-05
65 / 74 : Dice= 0.0
66 / 74 : Dice= 0.0
67 / 74 : Dice= 0.0
68 / 74 : Dice= 0.0
69 / 74 : Dice= 0.0
70 / 74 : Dice= 0.0
71 / 74 : Dice= 0.0
72 / 74 : Dice= 0.0
73 / 74 : Dice= 0.0
[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0009046908219116117, 0.0, 0.0, 0.0, 0.00254199508674084, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00252009867428612, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.004946671570430305, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0728130282082166e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
dice
0.00014829978761690484
0.0007020903168721888
### Make predictions on test dataset
## Patient 01
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 02
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 03
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 04
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 05
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 06
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 07
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 08
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 09
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 10
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 11
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 12
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 13
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 14
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 15
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 16
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 17
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 18
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 19
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
## Patient 20
# Vertebra 1
file not found
# Vertebra 2
file not found
# Vertebra 3
file not found
# Vertebra 4
file not found
# Vertebra 5
file not found
